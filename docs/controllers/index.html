<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Controllers - Decoy 5</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Decoy 5">
    <meta property="og:image" content="None/../images/decoy-logo-placeholder.png">
    <meta name="apple-mobile-web-app-title" content="Decoy 5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../images/decoy-logo-placeholder.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Raleway', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../css/style.css">
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Controllers
      </div>
    </div>
    
      
      <div class="button button-twitter" role="button" aria-label="Twitter">
        <a href="https://twitter.com/bkwld" title="@bkwld on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
      </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/bkwld" title="@bkwld on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../images/decoy-logo-placeholder.png">
        </div>
      
      <div class="name">
        <strong>
          Decoy 5
          <span class="version">
            
          </span>
        </strong>
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Setup" href="../setup/">
      Setup
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Getting Started" href="../getting_started/">
      Getting Started
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Models" href="../models/">
      Models
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Views" href="../views/">
      Views
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Controllers" href="./">
      Controllers
    </a>
    
      
      
        <ul>
          
            <li class="anchor">
              <a title="Protected properties" href="#protected-properties">
                Protected properties
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <span class="section">Features</span>
    <ul>
      
        
  <li>
    <a class="" title="Custom Form Fields" href="../custom_form_fields/">
      Custom Form Fields
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Elements" href="../elements/">
      Elements
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Images" href="../images/">
      Images
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Localization" href="../localization/">
      Localization
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Model Duplication" href="../model_duplication/">
      Model Duplication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Permissions" href="../permissions/">
      Permissions
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Slugs" href="../slugs/">
      Slugs
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Validation" href="../validation/">
      Validation
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Video Encoding" href="../video_encoding/">
      Video Encoding
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Workers" href="../workers/">
      Workers
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="WYSIWYG" href="../wysiwyg/">
      WYSIWYG
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
              
              <li>
                <a href="https://twitter.com/bkwld" target="_blank" title="@bkwld on Twitter">
                  @bkwld on Twitter
                </a>
              </li>
            
            
              
              <li>
                <a href="https://github.com/bkwld" target="_blank" title="@bkwld on GitHub">
                  @bkwld on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
            <h1>Controllers</h1>
          
          <p>A lot of Decoy&rsquo;s &ldquo;magic&rdquo; comes by having your admin controllers extend the <code>Bkwld\Decoy\Controllers\Base</code>.  I typically have the admin controllers extend an application specific base controller (i.e. <code>Admin\BaseController</code>) which then extends the <code>Bkwld\Decoy\Controllers\Base</code>.</p>
<h3 id="protected-properties">Protected properties</h3>
<p>The following protected proprties allow you to customize how Decoy works from the parent controller without overriding whole restful methods.  They generally affect the behavior of multiple methods.  They are all named with all-caps to indicate their significance and to differentiate them from other properties you might set in your admin controller.</p>
<ul>
<li><code>model</code> - The name of the controller associated with the controller.  For instance, &ldquo;Client&rdquo; in the examples above.  If left undefined, it&rsquo;s generated in the constructor based on the singular form of the controller name.  In addition, the constructor defines a class_alias of <code>Model</code> that you can use to refer to the model.  For instance, in a &ldquo;Clients&rdquo; controller, you could write <code>Model::find(2)</code> instead of <code>Client::find(2)</code>.</li>
<li><code>controller</code> - The &ldquo;path&rdquo;, in Laravel terms, of the controller (i.e. &ldquo;admin.clients&rdquo;).  If left undefined, it&rsquo;s generated in the constructor from the controller class name.</li>
<li><code>title</code> - The title used for the pages generated by the controller. If left undefined, it&rsquo;s generated in the constructor from the controller class name.</li>
<li><code>description</code> - An optional sentenance or two that is displayed with the title in the header of the page.</li>
<li><code>columns</code> - An array of key value pairs used to describe what table columns to have in the listing view.  The default is: <code>array('Title' =&gt; 'title')</code>.  The key is the label of the column, shown in the header of the table.  The value is the source for the data for the column.  Decoy first checks if there is a method defined on the model with the value and, if so, executes it to return the value.  If there is no method, it checks to see if the model has a property (or dynamic property) with that name and uses it&rsquo;s value of it does.  Finally, if none of those cases are true, it will use the value literally, rendering it in every row of the table.  Note: the default value, <code>title</code>, is the name of a method defined in <code>Decoy\Base_Model</code>.</li>
<li><code>show_view</code> - The path, in the Laravel format, to the view for the new/edit view.  I.e. &lsquo;admin.news.show&rsquo;.</li>
<li>
<p><code>search</code> - A multidimensional associative array that tells Decoy what fields to make available to the search on index views.  It expects data like:</p>
<p>```
array(</p>
<div class="code"><pre><span></span><span class="x">// &#39;title&#39; column assumed to be a text type</span>
<span class="x">&#39;title&#39;,</span>

<span class="x">// Label auto generated from field name</span>
<span class="x">&#39;description&#39; =&gt; &#39;text&#39;,</span>

<span class="x">// Most explicit way to define a text field</span>
<span class="x">&#39;body&#39; =&gt; array(</span>
<span class="x">    &#39;type&#39; =&gt; &#39;text&#39;,</span>
<span class="x">    &#39;label&#39; =&gt; &#39;Body&#39;,</span>
<span class="x">)</span>

<span class="x">// Creates a pulldown menu</span>
<span class="x">&#39;type&#39; =&gt; array(</span>
<span class="x">    &#39;type&#39; =&gt; &#39;select&#39;,</span>
<span class="x">    &#39;options&#39; =&gt; array(</span>
<span class="x">        &#39;photo&#39; =&gt; &#39;Photo&#39;,</span>
<span class="x">        &#39;video&#39; =&gt; &#39;Video&#39;,</span>
<span class="x">    ),</span>
<span class="x">),</span>

<span class="x">// Creates a pulldowon using static array on Post model</span>
<span class="x">&#39;category&#39; =&gt; array(</span>
<span class="x">    &#39;type&#39; =&gt; &#39;select&#39;,</span>
<span class="x">    &#39;options&#39; =&gt; &#39;Post::</span><span class="p">$</span><span class="nv">categories</span><span class="x">&#39;</span>
<span class="x">),</span>

<span class="x">// Numeric input field</span>
<span class="x">&#39;like_count&#39; =&gt; array(</span>
<span class="x">    &#39;type&#39; =&gt; &#39;number&#39;,</span>
<span class="x">    &#39;label&#39; =&gt; &#39;Like total&#39;,</span>

<span class="x">    // Call the static method `likeCountSearch`() on the `Admin\SomeController`</span>
<span class="x">    // class to override the query for the like_count field</span>
<span class="x">    &#39;query&#39; =&gt; &#39;Admin\SomeController::likeCountSearch&#39;</span>
<span class="x">),</span>

<span class="x">// Date input field</span>
<span class="x">&#39;created_at&#39; =&gt; &#39;date&#39;,</span>
</pre></div>


<p>);
```</p>
</li>
</ul>
<p>Several of these properties have accessor functions that can be overrode by subclasses.  This has the advantage of allowing you to generate the configuration programatically or to use closures in the configuration.  For instance:</p>
<div class="code"><pre><span></span><span class="err">```</span>
<span class="nt">class</span> <span class="nt">ArticlesController</span> <span class="p">{</span>

    <span class="o">//</span> <span class="n">Support</span> <span class="n">a</span> <span class="n">database</span> <span class="s2">&quot;SET&quot;</span> <span class="n">type</span> <span class="n">column</span> <span class="n">in</span> <span class="n">searches</span>
    <span class="n">public</span> <span class="n">function</span> <span class="n">search</span><span class="p">()</span> <span class="err">{</span>
        <span class="n">return</span> <span class="cp">[</span>
            <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="err">[</span>
                <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;select&#39;</span><span class="p">,</span>
                <span class="s1">&#39;options&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Article::$types&#39;</span><span class="p">,</span>

                <span class="c1">// Any search type supports the `query` parameter for change how the</span>
                <span class="c1">// field input is applied to the search query</span>
                <span class="s1">&#39;query&#39;</span> <span class="o">=&gt;</span> <span class="nx">function</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$condition</span><span class="p">,</span> <span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$type</span> <span class="o">=</span> <span class="nx">DB</span><span class="nl">::connection</span><span class="p">()</span><span class="o">-&gt;</span><span class="nx nx-Member">getPdo</span><span class="p">()</span><span class="o">-&gt;</span><span class="nx nx-Member">quote</span><span class="p">(</span><span class="nv">$type</span><span class="p">);</span>
                    <span class="nv">$query</span><span class="o">-&gt;</span><span class="nx nx-Member">whereRaw</span><span class="p">(</span><span class="s1">&#39;FIND_IN_SET(&#39;</span><span class="nx">.</span><span class="nv">$type.</span><span class="s1">&#39;, articles.type)&#39;</span><span class="p">);</span>
                <span class="p">},</span>
            <span class="cp">]</span><span class="o">,</span>
        <span class="p">];</span>
    <span class="p">}</span>

    <span class="o">//</span> <span class="nt">Other</span> <span class="nt">accessor</span> <span class="nt">functions</span>
    <span class="nt">public</span> <span class="nt">function</span> <span class="nt">description</span><span class="o">()</span> <span class="p">{</span> <span class="n">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> <span class="p">}</span>
    <span class="nt">public</span> <span class="nt">function</span> <span class="nt">columns</span><span class="o">()</span> <span class="p">{</span> <span class="n">return</span> <span class="cp">[]</span><span class="p">;</span> <span class="p">}</span>
<span class="err">}</span>
<span class="err">```</span>
</pre></div>


<p>The following properties are only relevant if a controller is a parent or child of another, as in <code>hasMany()</code>, <code>belongsToMany()</code>, etc.  You can typically use Decoy&rsquo;s default values for these (which are deduced from the <code>nav</code> Config property).</p>
<ul>
<li><code>parent_model</code> - The model used by the parent controller (i.e. &ldquo;Project&rdquo;).</li>
<li><code>parent_controller</code> - The parent controller (i.e. &ldquo;admin.projects&rdquo;).</li>
<li><code>parent_to_self</code> - The name of the relationship on the parent controller&rsquo;s model that refers to it&rsquo;s child (AKA the <em>current</em> controller&rsquo;s model, i.e. for &ldquo;admin.projects&rdquo; it would be &ldquo;projects&rdquo;).</li>
<li><code>self_to_parent</code> - The name of the relationship on the controller&rsquo;s model that refers to it&rsquo;s parent (i.e. for &ldquo;admin.projects&rdquo; it would be &ldquo;client&rdquo;).</li>
</ul>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../views/" title="Views">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Views
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../custom_form_fields/" title="Custom Form Fields">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Custom Form Fields
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = '';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>